<!DOCTYPE html>
<html lang="en" data-tech="off">
  <head>
    <meta charset="utf-8" />
    <link rel="icon" href="%sveltekit.assets%/favicon.png?v=2" />
    <meta name="viewport" content="width=device-width" />

    <!-- Apply saved theme ASAP to avoid flash -->
    <script>
      try {
        const t = localStorage.getItem("alexandria/theme") || "light";
        document.documentElement.dataset.theme = t;
        // Add .dark class for non-light themes
        if (t !== "light") {
          document.documentElement.classList.add("dark");
        }
      } catch (_) {
        /* no-op */
      }
    </script>

    <!-- Apply saved tech toggle ASAP; default is off -->
    <script>
      try {
        const v = localStorage.getItem("alexandria/showTech");
        document.documentElement.dataset.tech = v === "true"
          ? "on"
          : "off";
      } catch (_) {
        /* no-op */
      }
    </script>

    <!-- MathJax for math rendering -->
    <script>
      window.MathJax = {
        tex: {
          inlineMath: [
            ["$", "$"],
            ["\\(", "\\)"],
          ],
          displayMath: [
            ["$$", "$$"],
            ["\\[", "\\]"],
          ],
          processEscapes: true,
          processEnvironments: true,
        },
        options: {
          ignoreHtmlClass: "tex2jax_ignore",
          processHtmlClass: "tex2jax_process",
        },
      };
    </script>
    <script
      src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"
    ></script>

    <!-- highlight.js for code highlighting -->
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/styles/github-dark.min.css"
    />
    <script
      src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/highlight.min.js"
    ></script>

    %sveltekit.head%
  </head>

  <body data-sveltekit-preload-data="hover">
    <div style="display: contents">%sveltekit.body%</div>
  </body>
</html>

@import "./styles/base.css";
@import "./styles/scrollbar.css";
@import "./styles/publications.css";
@import "./styles/visualize.css";
@import "./styles/events.css";
@import "./styles/asciidoc.css";

/* Custom styles */
@layer base {
  .leather {
    @apply bg-primary-0 dark:bg-primary-1000 text-gray-900 dark:text-gray-100;
  }

  .btn-leather.text-xs {
    @apply px-2 py-1;
  }

  .btn-leather.text-xs svg {
    @apply h-3 w-3;
  }

  .btn-leather.text-sm {
    @apply px-3 py-2;
  }

  .btn-leather.text-sm svg {
    @apply h-4 w-4;
  }

  div[role="tooltip"] button.btn-leather {
    @apply hover:text-primary-600 dark:hover:text-primary-400 hover:border-primary-600 dark:hover:border-primary-400 hover:bg-gray-200 dark:hover:bg-gray-700;
  }

  .image-border {
    @apply border border-primary-700;
  }

  div.card-leather {
    @apply shadow-none text-primary-1000 border-s-4 bg-highlight border-primary-200 has-[:hover]:border-primary-700;
    @apply dark:bg-primary-1000 dark:border-primary-800 dark:has-[:hover]:bg-primary-950 dark:has-[:hover]:border-primary-500;
  }

  div.card-leather h1,
  div.card-leather h2,
  div.card-leather h3,
  div.card-leather h4,
  div.card-leather h5,
  div.card-leather h6 {
    @apply text-gray-900 hover:text-primary-600 dark:text-gray-100 dark:hover:text-primary-400;
  }

  div.card-leather .font-thin {
    @apply text-gray-900 hover:text-primary-700 dark:text-gray-100 dark:hover:text-primary-300;
  }

  main {
    @apply max-w-full flex;
  }

  main.publication {
    @apply mt-[70px];
  }

  /* To scroll columns independently */
  main.publication.blog {
    @apply w-full sm:w-auto min-h-full;
  }

  main.main-leather,
  article.article-leather {
    @apply bg-primary-0 dark:bg-primary-1000 text-gray-900 dark:text-gray-100;
  }

  div.note-leather,
  p.note-leather,
  section.note-leather {
    @apply bg-primary-0 dark:bg-primary-1000 text-gray-900 dark:text-gray-100 p-2 rounded;
  }

  .edit div.note-leather:hover:not(:has(.note-leather:hover)),
  .edit p.note-leather:hover:not(:has(.note-leather:hover)),
  section.edit.note-leather:hover:not(:has(.note-leather:hover)) {
    @apply hover:bg-primary-100 dark:hover:bg-primary-800;
  }

  h1.h-leather,
  h2.h-leather,
  h3.h-leather,
  h4.h-leather,
  h5.h-leather,
  h6.h-leather {
    @apply text-gray-900 dark:text-gray-100;
  }

  h1.h-leather {
    @apply text-4xl font-bold;
  }

  h2.h-leather {
    @apply text-3xl font-bold;
  }

  h3.h-leather {
    @apply text-2xl font-bold;
  }

  h4.h-leather {
    @apply text-xl font-bold;
  }

  h5.h-leather {
    @apply text-lg font-semibold;
  }

  h6.h-leather {
    @apply text-base font-semibold;
  }

  div.modal-leather > div {
    @apply bg-primary-0 dark:bg-primary-950 border-b-[1px] border-primary-100 dark:border-primary-600;
  }

  div.modal-leather > div > h1,
  div.modal-leather > div > h2,
  div.modal-leather > div > h3,
  div.modal-leather > div > h4,
  div.modal-leather > div > h5,
  div.modal-leather > div > h6 {
    @apply text-gray-900 hover:text-gray-900 dark:text-gray-100 dark:hover:text-gray-100;
  }

  div.modal-leather button {
    @apply bg-primary-0 hover:bg-primary-0 dark:bg-primary-950 dark:hover:bg-primary-950 text-gray-900 hover:text-primary-600 dark:text-gray-100 dark:hover:text-primary-400;
  }

  /* Navbar */
  nav.Navbar.navbar-main {
    @apply z-30;
  }

  nav.navbar-leather {
    @apply bg-primary-0 dark:bg-primary-1000 z-10;
  }

  nav.navbar-leather svg {
    @apply fill-gray-900 hover:fill-primary-600 dark:fill-gray-100 dark:hover:fill-primary-400;
  }

  nav.navbar-leather h1,
  nav.navbar-leather h2,
  nav.navbar-leather h3,
  nav.navbar-leather h4,
  nav.navbar-leather h5,
  nav.navbar-leather h6 {
    @apply text-gray-900 hover:text-primary-600 dark:text-gray-100 dark:hover:text-primary-400;
  }

  div.skeleton-leather div {
    @apply bg-primary-100 dark:bg-primary-800;
  }

  div.skeleton-leather {
    @apply h-48;
  }

  div.textarea-leather {
    @apply bg-primary-0 dark:bg-primary-1000;
  }

  div.textarea-leather > div:nth-child(1),
  div.toolbar-leather {
    @apply border-none;
  }

  div.textarea-leather > div:nth-child(2) {
    @apply bg-primary-0 dark:bg-primary-1000;
  }

  div.textarea-leather,
  div.textarea-leather textarea {
    @apply text-gray-900 dark:text-gray-100;
  }

  div.tooltip-leather {
    @apply text-gray-900 dark:text-gray-100;
  }

  div[role="tooltip"] button.btn-leather .tooltip-leather {
    @apply bg-primary-100 dark:bg-primary-800;
  }

  /* Network visualization */
  .network-link-leather {
    @apply stroke-primary-200 fill-primary-200;
  }

  .network-node-leather {
    @apply stroke-primary-600;
  }

  .network-node-content {
    @apply fill-primary-100;
  }
  
  /* Person link colors */
  .person-link-signed {
    @apply stroke-green-500;
  }
  
  .person-link-referenced {
    @apply stroke-blue-400;
  }
  
  /* Person anchor node */
  .person-anchor-node {
    @apply fill-green-400 stroke-green-600;
  }
}

/* Utilities can be applied via the @apply directive. */
@layer utilities {
  .h-leather {
    @apply text-gray-900 dark:text-gray-100 pt-4;
  }

  .h1-leather {
    @apply text-4xl font-bold;
  }

  .h2-leather {
    @apply text-3xl font-bold;
  }

  .h3-leather {
    @apply text-2xl font-bold;
  }

  .h4-leather {
    @apply text-xl font-bold;
  }

  .h5-leather {
    @apply text-lg font-semibold;
  }

  .h6-leather {
    @apply text-base font-semibold;
  }

  /* Line clamp utilities for text truncation */
  .line-clamp-1 {
    overflow: hidden;
    display: -webkit-box;
    -webkit-box-orient: vertical;
    -webkit-line-clamp: 1;
  }

  .line-clamp-2 {
    overflow: hidden;
    display: -webkit-box;
    -webkit-box-orient: vertical;
    -webkit-line-clamp: 2;
  }

  .line-clamp-3 {
    overflow: hidden;
    display: -webkit-box;
    -webkit-box-orient: vertical;
    -webkit-line-clamp: 3;
  }

  /* Lists */
  .ol-leather li a,
  .ul-leather li a {
    @apply text-gray-900 hover:text-primary-600 dark:text-gray-100 dark:hover:text-primary-400;
  }

  .link {
    @apply underline cursor-pointer hover:text-primary-600 dark:hover:text-primary-400;
  }

  /* Card with transition */
  .ArticleBox.grid .ArticleBoxImage {
    @apply max-h-0;
    transition: max-height 0.5s ease;
  }

  .ArticleBox.grid.active .ArticleBoxImage {
    @apply max-h-40;
  }

  .tags span {
    @apply bg-primary-50 text-primary-800 text-sm font-medium me-2 px-2.5 py-0.5 rounded-sm dark:bg-primary-900 dark:text-primary-200;
  }

  .npub-badge {
    @apply inline-flex space-x-1 items-center text-primary-600 dark:text-primary-500 hover:underline me-2 px-2 py-0.5 rounded-sm border border-primary-600 dark:border-primary-500;

    svg {
      @apply fill-primary-600 dark:fill-primary-500;
    }
  }
}

@layer components {
  /* Legend */
  .leather-legend {
    @apply relative m-4 sm:m-0 sm:absolute sm:top-1 sm:left-1 flex-shrink-0 p-2 rounded;
    @apply shadow-none text-primary-1000 border border-s-4 bg-highlight border-primary-200 has-[:hover]:border-primary-700;
    @apply dark:bg-primary-1000 dark:border-primary-800 dark:has-[:hover]:bg-primary-950 dark:has-[:hover]:border-primary-500;
  }

  /* Tooltip */
  .tooltip-leather {
    @apply fixed p-4 rounded shadow-lg bg-primary-0 dark:bg-primary-1000 text-gray-900 dark:text-gray-100 border border-gray-200 dark:border-gray-700 transition-colors duration-200;
    max-width: 400px;
    z-index: 1000;
  }

  .leather-legend button {
    @apply dark:text-white;
  }

  /* Rendered publication content */
  .publication-leather {
    @apply flex flex-col space-y-4;
    scroll-margin-top: 150px;
    scroll-behavior: smooth;

    h1,
    h2,
    h3,
    h4,
    h5,
    h6 {
      @apply h-leather;
    }

    h1 {
      @apply h1-leather;
    }

    h2 {
      @apply h2-leather;
    }

    h3 {
      @apply h3-leather;
    }

    h4 {
      @apply h4-leather;
    }

    h5 {
      @apply h5-leather;
    }

    h6 {
      @apply h6-leather;
    }

    div {
      @apply flex flex-col space-y-4;
    }

    .olist {
      @apply flex flex-col space-y-4;

      ol {
        @apply ol-leather list-decimal px-6 flex flex-col space-y-2;

        li {
          .paragraph {
            @apply py-2;
          }
        }
      }
    }

    .ulist {
      @apply flex flex-col space-y-4;

      ul {
        @apply ul-leather list-disc px-6 flex flex-col space-y-2;

        li {
          .paragraph {
            @apply py-2;
          }
        }
      }
    }

    a {
      @apply link;
    }

    .imageblock {
      @apply flex flex-col items-center;

      .title {
        @apply text-sm text-center;
      }
    }

    .stemblock {
      @apply bg-gray-200 dark:bg-gray-800 p-4 rounded-lg;
    }

    .literalblock {
      pre {
        @apply text-wrap;
      }
    }

    table {
      @apply w-full overflow-x-auto;

      caption {
        @apply text-sm;
      }

      thead,
      tbody {
        th,
        td {
          @apply border border-gray-200 dark:border-gray-700;
        }
      }
    }
  }

  /* Footnotes */
  .footnote-ref {
    text-decoration: none;
    color: var(--color-primary);
  }

  .footnotes {
    margin-top: 2rem;
    font-size: 0.875rem;
    color: var(--color-text-muted);
  }

  .footnotes hr {
    margin: 1rem 0;
    border-top: 1px solid var(--color-border);
  }

  .footnotes ol {
    padding-left: 1rem;
  }

  .line-ellipsis {
    overflow: hidden;
    text-overflow: ellipsis;
  }
  .footnotes li {
    margin-bottom: 0.5rem;
  }

  .footnote-backref {
    text-decoration: none;
    margin-left: 0.5rem;
    color: var(--color-primary);
  }

  .note-leather .footnote-ref,
  .note-leather .footnote-backref {
    color: var(--color-leather-primary);
  }

  /* Scrollable content */
  .description-textarea,
  .prose-content {
    overflow-y: scroll !important;
    scrollbar-width: thin !important;
    scrollbar-color: rgba(156, 163, 175, 0.5) transparent !important;
  }

  /* Section scroll behavior */
  section[id] {
    scroll-margin-top: 150px;
  }

  /* Ensure section headers maintain their padding */
  section[id] h1,
  section[id] h2,
  section[id] h3,
  section[id] h4,
  section[id] h5,
  section[id] h6 {
    @apply pt-4;
  }

  .description-textarea {
    min-height: 100% !important;
  }

  .description-textarea::-webkit-scrollbar,
  .prose-content::-webkit-scrollbar {
    width: 8px !important;
    display: block !important;
  }

  .description-textarea::-webkit-scrollbar-track,
  .prose-content::-webkit-scrollbar-track {
    background: transparent !important;
  }

  .description-textarea::-webkit-scrollbar-thumb,
  .prose-content::-webkit-scrollbar-thumb {
    background-color: rgba(156, 163, 175, 0.5) !important;
    border-radius: 4px !important;
  }

  .description-textarea::-webkit-scrollbar-thumb:hover,
  .prose-content::-webkit-scrollbar-thumb:hover {
    background-color: rgba(156, 163, 175, 0.7) !important;
  }

  /* Tab content */
  .tab-content {
    position: relative;
    display: flex;
    flex-direction: column;
  }

  /* Input styles */
  input[type="text"],
  input[type="email"],
  input[type="password"],
  input[type="search"],
  input[type="number"],
  input[type="tel"],
  input[type="url"],
  textarea {
    @apply bg-primary-0 dark:bg-primary-1000 text-gray-900 dark:text-gray-100 border-s-4 border-primary-200 rounded shadow-none px-4 py-2;
    @apply focus:border-primary-600 dark:focus:border-primary-400;
  }

  /* Table of Contents highlighting */
  .toc-highlight {
    @apply bg-primary-200 dark:bg-primary-700 border-l-4 border-primary-600 dark:border-primary-400 font-medium;
    transition: all 0.2s ease-in-out;
  }

  .toc-highlight:hover {
    @apply bg-primary-300 dark:bg-primary-600;
  }

  /* Timeline Table of Contents */
  .timeline-container {
    pointer-events: none;
  }

  .timeline-container .timeline-dot,
  .timeline-container .timeline-label {
    pointer-events: auto;
  }

  .timeline-container:hover .timeline-label {
    transition-delay: 0.1s;
  }

  .timeline-dot {
    box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
  }

  .timeline-dot:hover {
    box-shadow: 0 4px 8px rgba(0, 0, 0, 0.15);
  }

  .timeline-label {
    z-index: 40;
    min-width: 120px;
  }

  /* Ensure timeline doesn't interfere with content */
  @media (min-width: 1024px) {
    main.publication {
      margin-left: 2rem;
    }
  }
}
